// (C) Copyright 2006-2009 Hewlett-Packard Development Company, L.P.
//
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
// THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR
// OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,
// ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
// OTHER DEALINGS IN THE SOFTWARE.
//

// $Id$
#ifndef TOKENS_H
#define TOKENS_H

#define TOKEN_EVENT_SHIFT 0
#define TOKEN_EVENT_MASK  0x00000000FFFFFFFF
#define TOKEN_COUNT_SHIFT 32
#define TOKEN_COUNT_MASK  0x0000FFFF00000000
#define TOKEN_OPTION_SHIFT 48
#define TOKEN_OPTION_MASK  0xFFFF000000000000

#define TOKEN_EVENT(x)   ((((uint64_t)(x))&TOKEN_EVENT_MASK)>>TOKEN_EVENT_SHIFT)
#define TOKEN_COUNT(x)   ((((uint64_t)(x))&TOKEN_COUNT_MASK)>>TOKEN_COUNT_SHIFT)
#define TOKEN_OPTIONS(x) ((((uint64_t)(x))&TOKEN_OPTION_MASK)>>TOKEN_OPTION_SHIFT)

#define MAKE_EVENT(x,n) (((uint64_t)(x))|(((uint64_t)(n))<<TOKEN_COUNT_SHIFT))

#define EVENT_INSTRUCTION 0x00000001
#define EVENT_MEMORY      0x00000002 
#define EVENT_EXCEPTION   0x00000003
#define EVENT_REGISTER    0x00000004
#define EVENT_HEARTBEAT   0x00000005
#define EVENT_DISK_ID     0x00000006
#define EVENT_DISK_IO     0x00000007
#define EVENT_NIC_IO      0x00000008
#define EVENT_BRANCH      0x00000009
#define EVENT_PREFETCH    0x70000000
#define EVENT_CR3         0x80000000
#define EVENT_CPUID       0x90000000
#define EVENT_CLFLUSH     0xa0000000
#define EVENT_ASM         0xb0000000

#define INSTRUCTIONS_ON   0x00000003
#define INSTRUCTIONS_OFF  0x00000002

#define MEMORY_ON         0x00000001
#define MEMORY_OFF        0x00000000

#define EXCEPTION_ON      0x00000001
#define EXCEPTION_OFF     0x00000000

#define HEARTBEAT_ON      0x00000001
#define HEARTBEAT_OFF     0x00000000

#define REGISTER_ON       0x00000001
#define REGISTER_OFF      0x00000000

#define DISK_ID_ON        0x00000001
#define DISK_ID_OFF       0x00000000

#define DISK_IO_ON        0x00000002
#define DISK_IO_OFF       0x00000000

#define NIC_IO_ON         0x00000002
#define NIC_IO_OFF        0x00000000

#define MEMORY_ISREAD(t)  ((t)&0x0001)
#define MEMORY_ISWRITE(t) ((t)&0x0002)
#define MEMORY_HASPHYS(t) ((t)&0x0004)

#endif
